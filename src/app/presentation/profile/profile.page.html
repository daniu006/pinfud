<ion-content class="profile-content" fullscreen>

  <!-- Profile Header -->
  <div class="profile-header">
    <div class="header-top">
      <span class="header-title">Pinfüd</span>
    </div>

    <div class="user-info">
      <div class="avatar-wrapper" (click)="avatarInput.click()">
        <img [src]="vm.safeAvatar()" alt="Avatar" class="user-avatar" />
        <div class="avatar-edit-icon">
          <ion-icon name="camera"></ion-icon>
        </div>
      </div>
      <!-- Hidden File Input -->
      <input type="file" #avatarInput (change)="onAvatarChange($event)" accept="image/*" style="display: none;">

      @if (vm.user()) {
      <h2 class="user-name">{{ vm.user()?.name }}</h2>
      <p class="user-email">{{ vm.user()?.email }}</p>
      } @else {
      <ion-skeleton-text animated style="width: 150px; height: 24px; margin: 10px auto;"></ion-skeleton-text>
      <ion-skeleton-text animated style="width: 200px; height: 16px; margin: 5px auto;"></ion-skeleton-text>
      }
    </div>
  </div>

  <!-- My Photos & Saved Dishes Combined (Grid) -->
  <div class="saved-section">
    <div class="section-header">
      <span class="section-title">Mis Platos Guardados</span>
      <span class="section-count">{{ vm.allDishesCount() }}</span>
    </div>

    @if (vm.hasAnyDish()) {
    <div class="horizontal-scroll">
      @for (dish of vm.allDishes(); track dish.id) {
      <div class="dish-card-horizontal" (click)="onDishClick(dish)">
        <img [src]="dish.image" [alt]="dish.name" />
        <div class="dish-name-overlay">{{ dish.name }}</div>
      </div>
      }
    </div>
    } @else {
    <div class="empty-dishes">
      <ion-icon name="bookmark-outline"></ion-icon>
      <p>Aún no tienes platos guardados</p>
    </div>
    }
  </div>

  <!-- Action Buttons -->
  <div class="action-buttons">
    <button class="action-btn" (click)="onAddAccount()">
      <ion-icon name="person-add-outline"></ion-icon>
      <span>Agregar Cuenta</span>
    </button>

    <button class="action-btn" (click)="onGallery()">
      <ion-icon name="images"></ion-icon>
      <span>Mi Galería</span>
    </button>

    <button class="action-btn" (click)="onInfo()">
      <ion-icon name="information-circle-outline"></ion-icon>
      <span>Información</span>
    </button>

    <button class="action-btn logout" (click)="onLogout()">
      <ion-icon name="log-out-outline"></ion-icon>
      <span>Cerrar Sesión</span>
    </button>
  </div>

</ion-content>

<ion-footer class="ion-no-border">
  <div class="nav-btn" (click)="setActiveTab('home')">
    <ion-icon name="home-outline"></ion-icon>
  </div>

  <div class="nav-btn" (click)="setActiveTab('add')">
    <ion-icon name="add-outline"></ion-icon>
  </div>

  <div class="nav-btn" [class.has-badge]="vm.hasNotifications()" (click)="setActiveTab('notifications')">
    <ion-icon name="notifications-outline"></ion-icon>
    <div class="notification-badge" *ngIf="vm.hasNotifications()"></div>
  </div>
</ion-footer>